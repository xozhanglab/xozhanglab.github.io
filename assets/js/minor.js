(function($){function filterList(header,list){var filterform=$("<form>").attr({"class":"searchbox","action":"#"}),deftext="Filter by keyword ... (e.g. 'chromatin')",input=$("<input>").attr({"class":"searchbox","type":"text","value":deftext,"rel":deftext}),clear=$("<a>").text("").attr({"class":"searchbox","href":""}).css("visibility","hidden");$(filterform).append(clear).append(input).appendTo(header);$(input).blur(function(){var default_value=$(this).attr("rel");if($(this).val()==""){$(this).val(default_value);}}).focus(function(){var default_value=$(this).attr("rel");if($(this).val()==default_value){$(this).val("");}});$(clear).click(function(e){e.preventDefault();$(input).val("").focus();$(clear).css("visibility","hidden")
$(input).change();})
$(input).change(function(){var filter=$(this).val();var filterlist=$('#filterlist');if(filter){var phrase=filter.replace(/^\s+|\s+$/g,"");phrase=phrase.replace(/\s+/g,"|");phrase=["\\b(",phrase,")"].join("");var count=0;$('li',filterlist).each(function(i,v){var lib=$(v);var matches=false;lib.children('.pubtitle, .pubabstract, .pubauthors, .pubjournal').each(function(i2,v2){var block=$(v2);var matched=false;block.html(block.text().replace(new RegExp(phrase,"gi"),function(match){matches=true;matched=true;if(phrase.length>2){return["<span class='highlight'>",match,"</span>"].join("");}}));if(block.is(".pubabstract")){if(matched){block.slideDown();}else{block.slideUp();}}});if(matches){lib.slideDown();count++;}else{lib.slideUp()}});$(clear).css("visibility","visible");$(".filter-count").text(count+" results on this page!");}else{console.log("clear")
$(filterlist).find("li").slideDown();$(filterlist).find(".highlight").replaceWith(function(){console.log("clearing")
return $(this).contents();});$(".pubabstract").slideUp();$(clear).css("visibility","hidden");}
return false;}).keyup(function(){$(this).change();});}
$(function(){filterList($("#filterform"),$("#filterlist"));});}(jQuery));$(document).ready(function(){$("input.searchbox:first").focus();$("#filterlist li").click(function(e){var ab=$(this).children(".pubabstract").toggle("fast");})})